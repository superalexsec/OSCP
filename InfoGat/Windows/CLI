=========================== CMD ==============================
whoami /groups
systeminfo
ipconfig /all
route print
netstat -ano
net share

# Disabled state indicates for the running process, but the privilege still is there:
whoami /priv
# privileges to escalation:
# SeImpersonatePrivilege
# SeBackupPrivilege
# SeAssignPrimaryToken
# SeLoadDriver
# SeDebug
# IIS runs as LocalService, LocalSystem, NetworkService, or ApplicationPoolIdentity and them all have SeImpersonatePrivilege. 

# Find unquoted paths on services outside Windows folder:
wmic service get name,pathname |  findstr /i /v "C:\Windows\\" | findstr /i /v """
# Scheduled tasks:
schtasks /query /fo LIST /v
schtasks /query /fo LIST /v | findstr "Name Next"
schtasks /query /fo LIST /v | findstr "Name Next" | findstr /v Microsoft
schtasks /query /fo LIST /v /tn NetcatTask

# Will start a CMD with specific user:
runas /user:administrator cmd

======================== PowersHell ============;===============

# Get Local info:
dir env:
$env:path # see DLL hijacking
Get-LocalUser
Get-LocalGroup
Get-LocalGroupMember Administrators
Get-Process
Get-History
# If have history, where is it stored?
(Get-PSReadlineOption).HistorySavePath
# We can prevent PSReadline by setting the -HistorySaveStyle option to SaveNothing with the Set-PSReadlineOption Cmdlet.

# Local Programs
Get-ItemProperty "HKLM:\SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\Uninstall\*" | select displayname
Get-ItemProperty "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\*" | select displayname

# Will recursively find kdbx files on C: in powershell:
Get-ChildItem -Path C:\ -Include *.kdbx -File -Recurse -ErrorAction SilentlyContinue
Get-ChildItem -Path C:\xpto -Include *.txt,*.ini -File -Recurse -ErrorAction SilentlyContinue

# REMOTE SESSIONS
$password = ConvertTo-SecureString "Password123" -AsPlainText -Force
$cred = New-Object System.Management.Automation.PSCredential("superadmin", $password)
Enter-PSSession -ComputerName CLIENTWK220 -Credential $cred

# PowerShel loggin Script Block? Search the ID:
Get-WinEvent -FilterHashtable @{logname = "Microsoft-Windows-PowerShell/Operational"; id = 4104 } | select -ExpandProperty message
# We can prevent PSReadline by setting the -HistorySaveStyle option to SaveNothing with the Set-PSReadlineOption Cmdlet.
